{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NodeWebSocketTransport = void 0;\n\nconst ws_1 = __importDefault(require(\"ws\"));\n\nclass NodeWebSocketTransport {\n  constructor(ws) {\n    this._ws = ws;\n\n    this._ws.addEventListener('message', event => {\n      if (this.onmessage) this.onmessage.call(null, event.data);\n    });\n\n    this._ws.addEventListener('close', () => {\n      if (this.onclose) this.onclose.call(null);\n    }); // Silently ignore all errors - we don't know what to do with them.\n\n\n    this._ws.addEventListener('error', () => {});\n\n    this.onmessage = null;\n    this.onclose = null;\n  }\n\n  static create(url) {\n    return new Promise((resolve, reject) => {\n      const ws = new ws_1.default(url, [], {\n        perMessageDeflate: false,\n        maxPayload: 256 * 1024 * 1024\n      });\n      ws.addEventListener('open', () => resolve(new NodeWebSocketTransport(ws)));\n      ws.addEventListener('error', reject);\n    });\n  }\n\n  send(message) {\n    this._ws.send(message);\n  }\n\n  close() {\n    this._ws.close();\n  }\n\n}\n\nexports.NodeWebSocketTransport = NodeWebSocketTransport;","map":{"version":3,"sources":["../../../../src/node/NodeWebSocketTransport.ts"],"names":[],"mappings":";;;;;;;;;;;;;AAgBA,MAAA,IAAA,GAAA,eAAA,CAAA,OAAA,CAAA,IAAA,CAAA,CAAA;;AAEA,MAAa,sBAAb,CAAmC;AAmBjC,EAAA,WAAA,CAAY,EAAZ,EAA6B;AAC3B,SAAK,GAAL,GAAW,EAAX;;AACA,SAAK,GAAL,CAAS,gBAAT,CAA0B,SAA1B,EAAsC,KAAD,IAAU;AAC7C,UAAI,KAAK,SAAT,EAAoB,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,EAA0B,KAAK,CAAC,IAAhC;AACrB,KAFD;;AAGA,SAAK,GAAL,CAAS,gBAAT,CAA0B,OAA1B,EAAmC,MAAK;AACtC,UAAI,KAAK,OAAT,EAAkB,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB;AACnB,KAFD,EAL2B,CAQ3B;;;AACA,SAAK,GAAL,CAAS,gBAAT,CAA0B,OAA1B,EAAmC,MAAK,CAAG,CAA3C;;AACA,SAAK,SAAL,GAAiB,IAAjB;AACA,SAAK,OAAL,GAAe,IAAf;AACD;;AA9BY,SAAN,MAAM,CAAC,GAAD,EAAY;AACvB,WAAO,IAAI,OAAJ,CAAY,CAAC,OAAD,EAAU,MAAV,KAAoB;AACrC,YAAM,EAAE,GAAG,IAAI,IAAA,CAAA,OAAJ,CAAkB,GAAlB,EAAuB,EAAvB,EAA2B;AACpC,QAAA,iBAAiB,EAAE,KADiB;AAEpC,QAAA,UAAU,EAAE,MAAM,IAAN,GAAa;AAFW,OAA3B,CAAX;AAKA,MAAA,EAAE,CAAC,gBAAH,CAAoB,MAApB,EAA4B,MAC1B,OAAO,CAAC,IAAI,sBAAJ,CAA2B,EAA3B,CAAD,CADT;AAGA,MAAA,EAAE,CAAC,gBAAH,CAAoB,OAApB,EAA6B,MAA7B;AACD,KAVM,CAAP;AAWD;;AAoBD,EAAA,IAAI,CAAC,OAAD,EAAgB;AAClB,SAAK,GAAL,CAAS,IAAT,CAAc,OAAd;AACD;;AAED,EAAA,KAAK,GAAA;AACH,SAAK,GAAL,CAAS,KAAT;AACD;;AAvCgC;;AAAnC,OAAA,CAAA,sBAAA,GAAA,sBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NodeWebSocketTransport = void 0;\nconst ws_1 = __importDefault(require(\"ws\"));\nclass NodeWebSocketTransport {\n    constructor(ws) {\n        this._ws = ws;\n        this._ws.addEventListener('message', (event) => {\n            if (this.onmessage)\n                this.onmessage.call(null, event.data);\n        });\n        this._ws.addEventListener('close', () => {\n            if (this.onclose)\n                this.onclose.call(null);\n        });\n        // Silently ignore all errors - we don't know what to do with them.\n        this._ws.addEventListener('error', () => { });\n        this.onmessage = null;\n        this.onclose = null;\n    }\n    static create(url) {\n        return new Promise((resolve, reject) => {\n            const ws = new ws_1.default(url, [], {\n                perMessageDeflate: false,\n                maxPayload: 256 * 1024 * 1024,\n            });\n            ws.addEventListener('open', () => resolve(new NodeWebSocketTransport(ws)));\n            ws.addEventListener('error', reject);\n        });\n    }\n    send(message) {\n        this._ws.send(message);\n    }\n    close() {\n        this._ws.close();\n    }\n}\nexports.NodeWebSocketTransport = NodeWebSocketTransport;\n//# sourceMappingURL=NodeWebSocketTransport.js.map"]},"metadata":{},"sourceType":"script"}