(this.webpackJsonpbookfund=this.webpackJsonpbookfund||[]).push([[0],{150:function(e,t,n){},151:function(e,t,n){},164:function(e,t,n){"use strict";n.r(t);var s=n(1),i=n.n(s),c=n(56),r=n.n(c),a=(n(150),n(8)),o=n(12),l=(n(151),n(152),n(176)),u=n(0);function j(e){var t=e.setBooksFromSearch,n=e.startIndex,i=e.setStartIndex,c=Object(s.useState)(""),r=Object(a.a)(c,2),j=r[0],b=r[1],d=Object(o.g)();return Object(s.useEffect)((function(){var e=j.replace(/\s/g,"+");fetch("https://www.googleapis.com/books/v1/volumes?q=".concat(e,"&maxResults=8&startIndex=").concat(n)).then((function(e){return e.json()})).then((function(e){t(e.items)}))}),[n,j,t]),Object(u.jsx)("form",{onSubmit:function(e){e.preventDefault(),i(0);var s=j.replace(/\s/g,"+");fetch("https://www.googleapis.com/books/v1/volumes?q=".concat(s,"&maxResults=8&startIndex=").concat(n)).then((function(e){return e.json()})).then((function(e){t(e.items),d.push("/bookindex")}))},children:Object(u.jsx)(l.a,{icon:"search",placeholder:"Search...",type:"text",onChange:function(e){return b(e.target.value)},value:j,className:"search-input"})})}var b=n(21),d=n(23),h=n(178),f=n(165),p=n(177);function O(e){e.user;var t=e.setUser,n=Object(o.g)(),i=Object(s.useState)(!1),c=Object(a.a)(i,2),r=c[0],l=c[1],j=Object(s.useState)({eligible:!0}),O=Object(a.a)(j,2),m=O[0],x=O[1];function g(e){x(Object(d.a)(Object(d.a)({},m),{},Object(b.a)({},e.target.name,e.target.value)))}return Object(u.jsxs)(h.a,{onClose:function(){return l(!1)},onOpen:function(){return l(!0)},open:r,trigger:Object(u.jsx)(f.a,{children:"Sign Up"}),children:[Object(u.jsx)(h.a.Header,{children:"Sign Up"}),Object(u.jsx)(h.a.Content,{children:Object(u.jsxs)(p.a,{onSubmit:function(e){return function(e){e.preventDefault();var s=new FormData;m.username||alert("Please enter a username."),s.append("profile_pic",m.profile_pic),s.append("username",m.username),s.append("name",m.name),s.append("bio",m.bio),s.append("email",m.email);var i={method:"POST",body:s};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/users"),i).then((function(e){return e.json()})).then((function(e){e.error?(alert("Username must be unique"),x({})):(alert("welcome aboard ".concat(e.username,"!")),t(e),x({}),n.push("/userpage"))}))}(e)},children:[Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Name"}),Object(u.jsx)("input",{placeholder:"Name",name:"name",onChange:function(e){return g(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Username"}),Object(u.jsx)("input",{placeholder:"Username",name:"username",onChange:function(e){return g(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Email"}),Object(u.jsx)("input",{placeholder:"Email",name:"email",onChange:function(e){return g(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{placeholder:"Password",type:"password"})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Bio"}),Object(u.jsx)("input",{placeholder:"Bio",name:"bio",onChange:function(e){return g(e)}})]}),Object(u.jsx)(p.a.Input,{type:"file",name:"profile_pic",fluid:!0,label:"Image Upload",onChange:function(e){return function(e){e.persist(),x(Object(d.a)(Object(d.a)({},m),{},Object(b.a)({},e.target.name,e.target.files[0])))}(e)}}),Object(u.jsx)(f.a,{type:"submit",style:{float:"right",marginBottom:"10px"},children:"Sign Up"})]})})]})}function m(e){var t=e.setUser,n=e.user,i=Object(o.g)(),c=Object(s.useState)(!1),r=Object(a.a)(c,2),l=r[0],j=r[1],d=Object(s.useState)({}),O=Object(a.a)(d,2),m=O[0],x=O[1];return Object(s.useEffect)((function(){i.push("/userpage")}),[n,i]),Object(u.jsxs)(h.a,{onClose:function(){return j(!1)},onOpen:function(){return j(!0)},open:l,trigger:Object(u.jsx)(f.a,{children:" Log In "}),children:[Object(u.jsx)(h.a.Header,{children:"Log In"}),Object(u.jsx)(h.a.Content,{children:Object(u.jsx)("div",{className:"form ",children:Object(u.jsxs)(p.a,{onSubmit:function(e){return function(e){e.preventDefault(),j(!1);var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/users/login"),n).then((function(e){return e.json()})).then((function(e){t(e),i.push("/userpage")}))}(e)},children:[Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Username"}),Object(u.jsx)("input",{placeholder:"Username",name:"username",onChange:function(e){return function(e){x(Object(b.a)({},e.target.name,e.target.value))}(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{placeholder:"Password",type:"password"})]}),Object(u.jsx)(f.a,{type:"submit",style:{float:"right",marginBottom:"10px"},children:"Login"})]})})})]})}var x=n(11);function g(e){var t=e.setBooksFromSearch,n=e.setUser,s=e.user,i=e.startIndex,c=e.setStartIndex,r=Object(o.g)();return Object(u.jsx)("div",{className:"main-nav",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{className:"logo",children:Object(u.jsx)(x.c,{to:"/",style:{color:" #333"},children:Object(u.jsx)("h1",{className:"logo-text",children:"bookFun(d)"})})}),Object(u.jsx)("li",{className:"search-form",children:Object(u.jsx)(j,{setBooksFromSearch:t,startIndex:i,setStartIndex:c})}),Object(u.jsxs)("div",{className:"navLinks",children:[s?null:Object(u.jsx)(O,{user:s,setUser:n}),s?null:Object(u.jsx)(m,{style:{color:"inherit"},user:s,setUser:n}),s?Object(u.jsxs)(f.a,{children:[" ",Object(u.jsx)(x.c,{style:{color:"inherit"},to:"/userpage",children:"  My Page  "})]}):null,s?Object(u.jsx)(f.a,{onClick:function(){return r.push("/home"),void n(null)},children:"  Sign Out  "}):null,Object(u.jsx)(f.a,{children:Object(u.jsx)(x.c,{style:{color:"inherit"},to:"/",children:"  Home  "})})]})]})})}var v=n(179),k=n(135);function w(e){var t=e.book;return Object(u.jsxs)(v.a,{style:{textAlign:"center"},children:[Object(u.jsx)(k.a,{size:"tiny",src:t.volumeInfo.imageLinks?t.volumeInfo.imageLinks.thumbnail:null,wrapped:!0,ui:!1}),Object(u.jsxs)(v.a.Content,{children:[Object(u.jsx)(v.a.Header,{children:t.volumeInfo.title?Object(u.jsxs)(x.b,{to:"/bookpage/".concat(t.id),children:[t.volumeInfo.title.slice(0,50)," "]}):null}),Object(u.jsx)(v.a.Description,{children:t.volumeInfo.authors?t.volumeInfo.authors[0].slice(0,50):null})]})]})}function y(e){var t=e.booksFromSearch,n=e.startIndex,s=e.setStartIndex,i=[];return t&&(i=t.map((function(e){return Object(u.jsx)(w,{book:e})}))),Object(u.jsxs)("div",{className:"book-index",style:{marginTop:"100px"},children:[Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:i}),Object(u.jsxs)("div",{className:"buttons-combined",style:{marginTop:"20px"},children:[Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return s(n+8)},children:"Next"}),n>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return s(n-8)},children:"Back"}):null]})]})}function N(e){var t=e.waitingsMapped,n=e.book,i=e.user,c=(e.setUser,e.waitlistRequest),r=e.setWaitlistRequest,o=(e.setBackEndBook,e.backEndBook,e.toggleSponsorForm),l=e.setToggleSponsorForm,j=Object(s.useState)(0),b=Object(a.a)(j,2),d=b[0],h=b[1];return Object(u.jsxs)("form",{className:"signup",onSubmit:function(e){return function(e){e.preventDefault();var t={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({num_books_funded:e.target.number.value,sponsor_id:i.id})};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/waitings/sponsor/").concat(n.id),t).then((function(e){return e.json()})).then((function(e){l(!o),r(!c)}))}(e)},children:[Object(u.jsx)("label",{children:"Number of copies I'd like to sponsor:"}),Object(u.jsx)("input",{type:"number",name:"number",value:d,onChange:function(e){return h(e.target.value)}}),d>t.length?Object(u.jsx)("p",{style:{color:"red"},children:"Please enter a number smaller than the waitlist total"}):null,Object(u.jsx)("input",{type:"submit",value:"Sponsor",className:"button"})]})}var S=n(79),B=n.n(S);function _(e){var t=e.user,n=e.book,i=e.setSavedBooks,c=e.setWaitlistRequest,r=e.waitlistRequest,o=(e.waitListRequestAndStoreInDBRequest,e.backEndBook,e.setBackEndBook),l=e.storeInDB,j=Object(s.useState)({text:"",rating:0}),h=Object(a.a)(j,2),O=h[0],m=h[1];return Object(u.jsxs)("div",{children:[Object(u.jsx)("h3",{children:"Leave A Review"}),Object(u.jsx)(B.a,{className:"react-stars",count:5,onChange:function(e){t?(l(),m(Object(d.a)(Object(d.a)({},O),{},{rating:e}))):(m({}),alert("Please sign in to leave a rating."))},size:20,color2:"#ffd700",value:O.rating,name:"rating"}),Object(u.jsxs)(p.a,{reply:!0,onSubmit:function(e){return function(e){if(e.preventDefault(),O.text.length<100&&alert("Please leave a review with more than 100 characters."),O.text.length>100){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/reviews"),t).then((function(e){c(!r),o(!0),fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/books")).then((function(e){return e.json()})).then((function(e){i(e)}))}))}}(e)},children:[Object(u.jsx)(p.a.TextArea,{value:O.text,name:"text",rows:3,cols:25,onChange:function(e){return function(e){t?(l(),m(Object(d.a)(Object(d.a)({user_id:t.id,book_id:n.id},O),{},Object(b.a)({},e.target.name,e.target.value)))):(m({}),alert("Please sign in to leave a review."))}(e)}}),Object(u.jsx)(f.a,{type:"submit",content:"Add Review",labelPosition:"left",icon:"edit",primary:!0})]})]})}function C(e){var t=e.setSavedBooks,n=(e.savedBooks,e.user),i=e.setUser,c=(e.reviewLeft,Object(s.useState)({})),r=Object(a.a)(c,2),l=r[0],j=r[1],b=Object(s.useState)(!1),d=Object(a.a)(b,2),h=d[0],p=d[1],O=Object(s.useState)(!1),m=Object(a.a)(O,2),g=m[0],y=m[1],S=Object(s.useState)(!1),C=Object(a.a)(S,2),I=C[0],T=C[1],L=Object(s.useState)([]),F=Object(a.a)(L,2),P=F[0],R=F[1],D=Object(o.h)(),E=Object(s.useState)(0),U=Object(a.a)(E,2),A=U[0],M=U[1],z=Object(s.useState)(0),q=Object(a.a)(z,2),H=q[0],G=q[1],J=Object(s.useState)([]),W=Object(a.a)(J,2),V=W[0],K=W[1],Q=null,X=0,Y=null,Z=[],$=0,ee=[];function te(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""}function ne(){if(n){var e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/books"),e).then((function(e){return e.json()})).then((function(e){j(e),M(e.id);var t=e.id,s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:n.id,book_id:t,fulfilled:!1})};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/waitings"),s).then((function(e){return e.json()})).then((function(e){p(!0),y(!g),e.error&&alert("".concat(e.error))}))}))}else alert("Please sign in to join a waitlist.")}if(Object(s.useEffect)((function(){fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/books")).then((function(e){return e.json()})).then((function(e){var t;t=e.find((function(e){return e.api_id===D.id})),j(t),t&&(M(t.id),p(!0)),t||fetch("https://www.googleapis.com/books/v1/volumes/".concat(D.id)).then((function(e){return e.json()})).then((function(e){var t="",n="",s=[""],i="",c="",r="",a="";e.volumeInfo.title&&(t=e.volumeInfo.title),e.volumeInfo.authors&&(s=e.volumeInfo.authors),e.volumeInfo.subtitle&&(n=e.volumeInfo.subtitle),e.volumeInfo.publisher&&(i=e.volumeInfo.publisher),e.volumeInfo.publishedDate&&(c=e.volumeInfo.publishedDate),e.volumeInfo.description&&(r=e.volumeInfo.description),e.volumeInfo.imageLinks&&(a=e.volumeInfo.imageLinks.thumbnail),j({title:t,subtitle:n,authors:s.join(", "),publisher:i,publishedDate:c,description:te(r),image_url:a,api_id:e.id,waitings:[],reviews:[]})}))})),fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/users")).then((function(e){return e.json()})).then((function(e){return K(e)}))}),[g,h,D.id,A]),Object(s.useEffect)((function(){if(l&&l.title){var e=l.title.split(" ").pop();fetch("https://www.googleapis.com/books/v1/volumes?q=".concat(e,"&maxResults=20")).then((function(e){return e.json()})).then((function(e){R(e.items)}))}}),[l]),P.length>0&&(Z=P.slice(H,H+3).map((function(e){return Object(u.jsx)(w,{book:e})}))),!0===h&&l){if(V.length>0){var se=l.waitings.filter((function(e){return!0===e.fulfilled})),ie=[];ee=(ee=se.map((function(e){var t=se.filter((function(t){return t.sponsor_id===e.sponsor_id})).length;return ie.find((function(t){return t===e.sponsor_id}))?null:(ie.push(e.sponsor_id),Object(u.jsxs)("li",{children:[Object(u.jsx)(k.a,{src:V.find((function(t){return t.id===e.sponsor_id})).profile_pic?V.find((function(t){return t.id===e.sponsor_id})).profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsx)(x.b,{to:"/otheruserpage/".concat(e.sponsor_id),children:V.find((function(t){return t.id===e.sponsor_id})).username}),Object(u.jsxs)("div",{style:{float:"right"},children:[" ",t," ",1===t?" copy":"copies"]})]}))}))).filter((function(e){return null!==e}))}Q=l.waitings.filter((function(e){return!0!==e.fulfilled})).map((function(e){return Object(u.jsxs)("li",{children:[Object(u.jsx)(k.a,{src:e.user.profile_pic?e.user.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsxs)(x.b,{to:"/otheruserpage/".concat(e.user.id),children:[e.user.username," ",e.user.eligible?"(eligible)":"(ineligible)"]})]})})),X=l.waitings.filter((function(e){return!0===e.fulfilled})).map((function(e){return Object(u.jsxs)("li",{children:[Object(u.jsx)(k.a,{src:e.user.profile_pic?e.user.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsx)(x.b,{to:"/otheruserpage/".concat(e.user.id),children:e.user.username})]})})),Y=l.reviews.map((function(e){if(n){return $=l.reviews.map((function(e){return e.rating})).reduce((function(e,t){return e+t}))/l.reviews.length,Object(u.jsxs)("div",{className:"review",children:[Object(u.jsx)(k.a,{src:e.user.profile_pic?e.user.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsx)(x.b,{to:"/otheruserpage/".concat(e.user.id),children:e.user.username}),Object(u.jsx)(B.a,{className:"react-stars",count:5,value:e.rating,size:15,color2:"#ffd700",edit:!1}),e.text,e.user.id===n.id?Object(u.jsx)(f.a,{size:"mini",id:e.id,onClick:function(e){return function(e){var t=parseInt(e.target.id),n={method:"DELETE",headers:{"Content-Type":"application/json"}};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/reviews/").concat(t),n).then((function(e){return y(!g)}))}(e)},children:"Delete"}):null]})}return $=l.reviews.map((function(e){return e.rating})).reduce((function(e,t){return e+t}))/l.reviews.length,Object(u.jsxs)("li",{children:[Object(u.jsxs)("div",{children:[Object(u.jsx)(k.a,{src:e.user.profile_pic?e.user.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsx)(x.b,{to:"/otheruserpage/".concat(e.user.id),children:e.user.username}),Object(u.jsx)(B.a,{className:"react-stars",count:5,value:e.rating,size:15,color2:"#ffd700",edit:!1})]}),e.text]})}))}return Object(u.jsxs)("div",{className:"bookpage",children:[Object(u.jsxs)("div",{className:"book-info",children:[Object(u.jsx)("div",{className:"book-info-image",children:Object(u.jsx)(k.a,{style:{margin:"40px",float:"right"},size:"small-medium",src:l?l.image_url:"N/A"})}),Object(u.jsxs)("div",{className:"book-info-info",children:[Object(u.jsx)("h2",{style:{marginBottom:"-15px"},children:l?l.title:"N/A"}),Object(u.jsx)("h3",{children:l?l.subtitle:"N/A"}),Y?Object(u.jsx)(B.a,{className:"react-stars",count:5,value:$,size:20,color2:"#ffd700",edit:!1}):null,Object(u.jsx)("b",{children:"by:"})," ",l?l.authors:"N/A"," (",l?l.publishedDate:"N/A",")",Object(u.jsx)("br",{}),Object(u.jsx)("b",{children:"Publishing House:"})," ",l?l.publisher:"N/A",Object(u.jsx)("br",{}),Object(u.jsx)("b",{children:"Description:"}),Object(u.jsx)("p",{children:l?l.description:"N/A"})]})]}),l?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{className:"reviews",children:[Object(u.jsx)("h3",{children:"Reviews"}),h&&Y.length>0?Object(u.jsxs)("ul",{className:"reviewsUl",children:[" ",Y," "]}):"No one has reviewed this book yet. Be the first!",Object(u.jsx)(_,{storeInDB:function(){if(n){var e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/books"),e).then((function(e){return e.json()})).then((function(e){j(e),M(e.id),p(!0),y(!g)}))}else alert("Please sign in to leave a review.")},user:n,book:l,waitlistRequest:g,setWaitlistRequest:y,backEndBook:h,setBackEndBook:p,setSavedBooks:t,waitListRequestAndStoreInDBRequest:ne,toggleSponsorForm:I,setToggleSponsorForm:T})]}),Object(u.jsxs)("div",{className:"bookpage-recipients-list",children:[Object(u.jsx)("h3",{style:{textAlign:"center"},children:"Recipients"}),h&&X.length>0?Object(u.jsxs)("ol",{children:[" ",X,"  "]}):"No one has received this book yet. Join the waitlist to be the first!"]}),Object(u.jsxs)("div",{className:"bookpage-waiting-list",children:[Object(u.jsx)("h3",{style:{textAlign:"center"},children:"Waitlist"}),Object(u.jsxs)("ol",{children:[h&&Q.length>0?Q:"No one is currently waiting for this book. Be the first!"," "]}),Object(u.jsx)(f.a,{className:"waiting-button",onClick:ne,children:"Join the Waitlist"})]}),Object(u.jsxs)("div",{className:"bookpage-sponsor-list",children:[Object(u.jsx)("h3",{style:{textAlign:"center"},children:"Sponsors"}),Object(u.jsxs)("ol",{children:[h&&ee.length>0?ee:"No one has sponsored this book yet.  Be the first!"," "]}),Object(u.jsx)(f.a,{onClick:function(){n?h?T(!I):alert("There is no one on the waitlist."):alert("Please log in to Sponsor")},children:" Sponsor this Book"}),I?Object(u.jsx)(N,{waitingsMapped:Q,book:l,user:n,setUser:i,waitlistRequest:g,setWaitlistRequest:y,setBackEndBook:p,backEndBook:h,setToggleSponsorForm:T,toggleSponsorForm:I}):null]})]}):null,Object(u.jsxs)("div",{className:"similar-books",children:[Object(u.jsx)("h3",{children:"Similar Books"}),P.length>0?Object(u.jsx)(v.a.Group,{itemsPerRow:3,children:Z}):null,Object(u.jsxs)("div",{className:"buttons-combined",children:[Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){H<P.length-2?G(H+3):alert("No More Books to Display")},children:"See More"}),H>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){G(H-3)},children:"Go Back"}):null]})]})]})}function I(e){var t=e.book,n=e.style;return t?Object(u.jsxs)(v.a,{style:{textAlign:"center",style:n},children:[Object(u.jsx)(k.a,{size:"small",src:t.image_url?t.image_url:null,wrapped:!0,ui:!1}),Object(u.jsxs)(v.a.Content,{children:[Object(u.jsx)(v.a.Header,{children:t.title?Object(u.jsxs)(x.b,{to:"/bookpage/".concat(t.api_id),children:[t.title.slice(0,50)," "]}):null}),Object(u.jsx)(v.a.Meta,{children:t.subtitle?t.subtitle.slice(0,50):null}),Object(u.jsx)(v.a.Description,{children:Object(u.jsx)("span",{className:"date",children:t.authors?t.authors:null})})]})]}):null}var T=n(61);function L(){var e=Object(s.useState)([]),t=Object(a.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)([]),r=Object(a.a)(c,2),o=r[0],l=r[1],j=Object(s.useState)([]),d=Object(a.a)(j,2),h=d[0],p=d[1],O=Object(s.useState)(0),m=Object(a.a)(O,2),g=m[0],w=m[1],y=[],N=[],S=[],B=[];if(Object(s.useEffect)((function(){fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/books")).then((function(e){return e.json()})).then((function(e){i(e)})),fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/users")).then((function(e){return e.json()})).then((function(e){p(e)})),fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/waitings")).then((function(e){return e.json()})).then((function(e){l(e)}))}),[]),n.length>0){for(var _=0;_<n.length;_++){var C=n[_].waitings.filter((function(e){return!1!==e.fulfilled})).length;y.push(Object(b.a)({},C,n[_]))}y.sort((function(e,t){return Object.keys(t)[0]-Object.keys(e)[0]})),N=y.slice(g,g+8).map((function(e){return Object(u.jsx)(I,{book:Object.values(e)[0]})}))}if(o.length>0){for(var L=o.filter((function(e){return!0===e.fulfilled})),F=[],P=function(e){var t=L.filter((function(t){return t.sponsor_id===h[e].id}));F.push(Object(b.a)({},t.length,h[e]))},R=0;R<h.length;R++)P(R);S=F.sort((function(e,t){return Object.keys(t)[0]-Object.keys(e)[0]})).slice(0,3).map((function(e){return Object(u.jsxs)(v.a,{children:[Object(u.jsx)(v.a.Header,{children:Object(u.jsxs)(x.b,{to:"/otheruserpage/".concat(Object.values(e)[0].id),children:[" ",Object(u.jsx)("h4",{style:{textAlign:"center"},children:Object.values(e)[0].username})," "]})}),Object(u.jsx)(v.a.Content,{style:{textAlign:"center"},children:Object(u.jsx)(k.a,{style:{margin:"auto"},src:Object.values(e)[0].profile_pic?Object.values(e)[0].profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"small",circular:!0})}),Object(u.jsxs)(v.a.Content,{extra:!0,children:[Object(u.jsx)(T.a,{name:"user"}),Object.keys(e)[0]," sponsors"]})]})}))}return h.length>0&&(B=h.sort((function(e,t){return t.waitings.filter((function(e){return!0===e.fulfilled})).length-e.waitings.filter((function(e){return!0===e.fulfilled})).length})).slice(0,3).map((function(e){return Object(u.jsxs)(v.a,{children:[Object(u.jsx)(v.a.Header,{children:Object(u.jsxs)(x.b,{to:"/otheruserpage/".concat(e.id),children:[" ",Object(u.jsxs)("h4",{style:{textAlign:"center"},children:[e.username," "]})]})}),Object(u.jsx)(v.a.Content,{style:{textAlign:"center"},children:Object(u.jsx)(k.a,{src:e.profile_pic?e.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"small",circular:!0})}),Object(u.jsxs)(v.a.Content,{extra:!0,children:[Object(u.jsx)(T.a,{name:"book"}),e.waitings.filter((function(e){return!0===e.fulfilled})).length," Books Read"]})]})}))),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{className:"home-info",children:[Object(u.jsx)("h2",{className:"who",children:"Who we are"}),Object(u.jsxs)("p",{style:{fontSize:"15px"},children:["If you've ever read an impactful book that you'd like to share with others, BookFund is the place for you!",Object(u.jsx)("br",{}),"BookFund is a simple way for users to sponsor books they love and share the knowledge with others.",Object(u.jsx)("br",{}),"Users can sign up for a book via a waitlist to receive the next sponsored copy of that book. After receiving a book, users must publish a review of the book on the site, as well as enter a two week wait period before they are eligible to receive their next book."]})]}),Object(u.jsx)("h2",{className:"pop",children:"Popular Now"}),Object(u.jsx)("div",{className:"popular-now",children:N.length>0?Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:N}):null}),Object(u.jsxs)("div",{className:"buttons-combined",children:[Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return w(g+8)},children:"Next"}),g>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return w(g-8)},children:"Back"}):null]}),Object(u.jsxs)("div",{style:{display:"flex",marginTop:"50px"},className:"bottom-home",children:[Object(u.jsxs)("div",{className:"top-readers-home",children:[Object(u.jsx)("h4",{children:"Top Readers:"}),Object(u.jsx)(v.a.Group,{itemsPerRow:3,children:B.length>0?B:null})]}),Object(u.jsxs)("div",{className:"top-sponsors-home",children:[Object(u.jsx)("h4",{children:"Top Sponsors:"}),Object(u.jsx)(v.a.Group,{itemsPerRow:3,children:S.length>0?S:null})]})]})]})}var F=function(e){var t=e.mostRecent,n=(e.timeLeft,e.setTimeLeft),i=(e.displayTimer,e.setDisplayTimerTwo),c=(e.reviewLeft,Object(s.useState)(0)),r=Object(a.a)(c,2),o=r[0],l=r[1],j=Object(s.useState)(0),b=Object(a.a)(j,2),d=b[0],h=b[1],f=Object(s.useState)(0),p=Object(a.a)(f,2),O=p[0],m=p[1],x=Object(s.useState)(0),g=Object(a.a)(x,2),v=g[0],k=g[1],w=Object(s.useRef)();return Object(s.useEffect)((function(){var e=w.current;return function(){var e=new Date(parseInt(t.sponsor_date)+6e4);w=setInterval((function(){var t=(new Date).getTime(),s=e-t,c=Math.floor(s/864e5),r=Math.floor(s%864e5/36e5),a=Math.floor(s%36e5/6e4),o=Math.floor(s%6e4/1e3);s<0?(n(!1),clearInterval(w.current),!1,i(!1)):(l(c),h(r),m(a),k(o))}),1e3)}(),function(){clearInterval(e)}})),Object(u.jsxs)("div",{class:"container",children:[Object(u.jsx)("h1",{id:"headline",children:"Countdown until your next book:"}),Object(u.jsx)("div",{id:"countdown",children:Object(u.jsxs)("ul",{children:[Object(u.jsxs)("li",{children:[Object(u.jsx)("span",{id:"numbers",children:o}),"days"]}),Object(u.jsxs)("li",{children:[Object(u.jsx)("span",{id:"numbers",children:d}),"Hours"]}),Object(u.jsxs)("li",{children:[Object(u.jsx)("span",{id:"numbers",children:O}),"Minutes"]}),Object(u.jsxs)("li",{children:[Object(u.jsxs)("span",{id:"numbers",children:[v," "]}),"Seconds"]})]})})]})};function P(e){var t=e.allWaitings,n=e.user,i=e.savedBooks,c=[],r=[],o=Object(s.useState)(0),l=Object(a.a)(o,2),j=l[0],b=l[1];if(t.length>0&&(c=t.filter((function(e){return e.sponsor_id===n.id}))).length>0){var d=[];d.push(c[0]);for(var h=function(e){d.find((function(t){return t.book_id===c[e].book_id}))||d.push(c[e])},p=1;p<c.length;p++)h(p);r=d.map((function(e){return Object(u.jsx)(I,{book:i.find((function(t){return t.id===e.book_id}))})})),console.log(r)}return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:r.slice(j,j+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return b(j+8)},children:"Next"}),j>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return b(j-8)},children:"Back"}):null]})}function R(e){for(var t=e.waitlistMapped,n=e.user,i=e.savedBooks,c=Object(s.useState)(0),r=Object(a.a)(c,2),o=r[0],l=r[1],j=[],b=n.waitings.filter((function(e){return!0!==e.fulfilled})),d=function(e){j.push(i.find((function(t){return t.id===b[e].book_id})))},h=0;h<b.length;h++)d(h);return j.length>0&&(t=j.map((function(e){return Object(u.jsx)(I,{book:e})}))),j.length>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:t.slice(o,o+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){o<t.length&&(t.length-o>8?l(o+8):l(0))},children:"Next"}),o>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return l(o-8)},children:"Back"}):null]}):null}function D(e){var t=e.savedBooks,n=e.waitingsFulFilledMapped,i=e.waitlistMapped,c=Object(s.useState)(0),r=Object(a.a)(c,2),o=r[0],l=r[1],j=null;return t.length>0&&(j=n.map((function(e){return Object(u.jsx)(I,{book:e})}))),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:j.slice(o,o+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){o<i.length&&(i.length-o>8?l(o+8):l(0))},children:"Next"}),o>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return l(o-8)},children:"Back"}):null]})}function E(e){var t=e.user,n=e.savedBooks,i=e.timeLeft,c=e.setTimeLeft,r=e.reviewLeft,l=e.setReviewLeft,j=[],h={},O=null,m=null,x=!1,g=Object(s.useState)([]),v=Object(a.a)(g,2),w=v[0],y=v[1],N=Object(s.useState)(!0),S=Object(a.a)(N,2),B=S[0],_=S[1],C=Object(s.useState)(!1),T=Object(a.a)(C,1)[0],L=Object(s.useState)({}),E=Object(a.a)(L,2),U=E[0],A=E[1];function M(e){console.log(e),A(Object(d.a)(Object(d.a)({},U),{},Object(b.a)({},e.target.name,e.target.value)))}return Object(s.useEffect)((function(){fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/waitings")).then((function(e){return e.json()})).then((function(e){return y(e)}))}),[]),t&&function(){t.waitings.length<1&&(c(!1),l(!0));for(var e=t.waitings.filter((function(e){return!0===e.fulfilled})),s=function(t){j.push(n.find((function(n){return n.id===e[t].book_id})))},i=0;i<e.length;i++)s(i);if(e.length<1&&l(!0),e.length>0){if(h=e.sort((function(e,t){return t.id-e.id}))[0],0!==Object.keys(h).length){var r=new Date(parseInt(h.sponsor_date)+6e4).getTime();(new Date).getTime()<r?x=!0:(x=!1,console.log("setTimeLeft(false)"),c(!1))}(O=n.find((function(e){return e.id===h.book_id})))?(m=O.reviews.find((function(e){return e.user.id===t.id})),l(!!m)):l(!0)}}(),t?Object(u.jsxs)("div",{className:"userpage",children:[Object(u.jsxs)("div",{className:"userpage-top-half",children:[Object(u.jsxs)("div",{className:"userpage-eligibility-info",style:{float:"left"},children:[x&&B?Object(u.jsx)(F,{mostRecent:h,timeLeft:i,setTimeLeft:c,displayTimer:x,setDisplayTimerTwo:_,reviewLeft:r}):null,!1===x&&!0===r?Object(u.jsx)("h3",{children:"Looks like you're eligible for your next book!"}):null,!1===r&&null!==h&&t.waitings.length>0?Object(u.jsxs)("div",{style:{margin:"auto"},children:[" ",Object(u.jsx)("h3",{children:"Please leave a review for"})," ",Object(u.jsx)("div",{style:{margin:"auto"},children:Object(u.jsx)(I,{book:O,style:{margin:"auto"}})})," "]}):null]}),Object(u.jsxs)("div",{className:"userpage-user-info",children:[Object(u.jsx)("h3",{children:"Profile"}),Object(u.jsx)(k.a,{src:t.profile_pic?t.profile_pic:null,size:"small",circular:!0,style:{float:"left"}}),T?null:Object(u.jsxs)("div",{style:{float:"left",marginLeft:"50px"},children:[Object(u.jsx)("h4",{style:{display:"inline"},children:"Name: "}),"undefined"!==t.name?t.name:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Email: "}),"undefined"!==t.email?t.email:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Username: "}),"undefined"!==t.username?t.username:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Bio: "}),"undefined"!==t.bio?t.bio:null]}),T?Object(u.jsx)("div",{style:{float:"left",marginLeft:"50px"},children:Object(u.jsxs)(p.a,{onSubmit:function(e){return function(e){e.preventDefault();var t=new FormData;U.username||alert("Please enter a username."),t.append("profile_pic",U.profile_pic),t.append("username",U.username),t.append("name",U.name),t.append("bio",U.bio),t.append("email",U.email)}(e)},children:[Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Name"}),Object(u.jsx)("input",{placeholder:"Name",name:"name",onChange:function(e){return M(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Username"}),Object(u.jsx)("input",{placeholder:"Username",name:"username",onChange:function(e){return M(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Email"}),Object(u.jsx)("input",{placeholder:"Email",name:"email",onChange:function(e){return M(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{placeholder:"Password",type:"password"})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Bio"}),Object(u.jsx)("input",{placeholder:"Bio",name:"bio",onChange:function(e){return M(e)}})]}),Object(u.jsx)(p.a.Input,{type:"file",name:"profile_pic",fluid:!0,label:"Image Upload",onChange:function(e){return function(e){e.persist(),A(Object(d.a)(Object(d.a)({},U),{},Object(b.a)({},e.target.name,e.target.files[0])))}(e)}}),Object(u.jsx)(f.a,{type:"submit",style:{float:"right",marginBottom:"10px"},children:"Sign Up"})]})}):null]})]}),Object(u.jsx)("h3",{className:"pop",children:"Waitlist"}),Object(u.jsx)(R,{waitlistMapped:0,user:t,savedBooks:n}),Object(u.jsx)("h3",{className:"pop",children:"Received"}),j.length>0?Object(u.jsx)(D,{waitingsFulFilledMapped:j,savedBooks:n,waitlistMapped:0}):null,Object(u.jsx)("h3",{className:"pop",children:"Sponsored"}),Object(u.jsx)(P,{allWaitings:w,savedBooks:n,user:t})]}):Object(u.jsxs)(u.Fragment,{children:["Error. Please try again",Object(u.jsx)(o.a,{to:"/bookindex"})]})}function U(e){var t=e.savedBooks,n=(e.timeLeft,e.setTimeLeft),i=(e.reviewLeft,e.setReviewLeft),c=[],r=[],l={},j=null,b=null,d=null,h=null,p=[],O=[],m=Object(s.useState)([]),x=Object(a.a)(m,2),g=x[0],w=x[1],y=Object(s.useState)(0),N=Object(a.a)(y,2),S=N[0],B=N[1],_=Object(s.useState)(0),C=Object(a.a)(_,2),T=C[0],L=C[1],F=Object(s.useState)(0),P=Object(a.a)(F,2),R=P[0],D=P[1],E=Object(s.useState)(null),U=Object(a.a)(E,2),A=U[0],M=U[1],z=Object(o.h)();return Object(s.useEffect)((function(){fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/users/").concat(z.id)).then((function(e){return e.json()})).then((function(e){return M(e)}))}),[z.id]),Object(s.useEffect)((function(){fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/waitings")).then((function(e){return e.json()})).then((function(e){return w(e)}))}),[]),A&&function(){A.waitings.length<1&&(console.log("setTimeLeft(false)"),n(!1),i(!0));for(var e=A.waitings.filter((function(e){return!0!==e.fulfilled})),s=function(n){c.push(t.find((function(t){return t.id===e[n].book_id})))},a=0;a<e.length;a++)s(a);if(c.length>0&&(h=c.map((function(e){return Object(u.jsx)(I,{book:e})}))),g.length>0&&(p=g.filter((function(e){return e.sponsor_id===A.id}))).length>0){var o=[];o.push(p[0]);for(var f=function(e){o.find((function(t){return t.book_id===p[e].book_id}))||o.push(p[e])},m=1;m<p.length;m++)f(m);O=o.map((function(e){return Object(u.jsx)(I,{book:t.find((function(t){return t.id===e.book_id}))})}))}for(var x=A.waitings.filter((function(e){return!0===e.fulfilled})),v=function(e){r.push(t.find((function(t){return t.id===x[e].book_id})))},k=0;k<x.length;k++)v(k);if(x.length<1&&i(!0),t.length>0&&(d=r.map((function(e){return Object(u.jsx)(I,{book:e})}))),x.length>0){if(l=x.sort((function(e,t){return t.id-e.id}))[0],0!==Object.keys(l).length){var w=new Date(parseInt(l.sponsor_date)+6e4).getTime();(new Date).getTime()<w||(console.log("setTimeLeft(false)"),n(!1))}(j=t.find((function(e){return e.id===l.book_id})))?(b=j.reviews.find((function(e){return e.user.id===A.id})),i(!!b)):i(!0)}}(),A?(console.log("eligibilty:",A.eligible),Object(u.jsxs)("div",{className:"userpage",children:[Object(u.jsxs)("div",{className:"userpage-top-half",children:[Object(u.jsx)("div",{className:"userpage-eligibility-info",style:{float:"left"},children:A.eligible?Object(u.jsxs)("h3",{children:["Looks like ",A.username," is eligible for their next book!"]}):Object(u.jsxs)("h3",{children:["Looks like ",A.username," needs to wait two weeks or leave a review to be eligible for their next book!"]})}),Object(u.jsxs)("div",{className:"userpage-user-info",children:[Object(u.jsx)("h3",{children:"Profile"}),Object(u.jsx)(k.a,{src:A.profile_pic?A.profile_pic:null,size:"small",circular:!0,style:{float:"left"}}),Object(u.jsxs)("div",{style:{float:"left",marginLeft:"50px"},children:[Object(u.jsx)("h4",{style:{display:"inline"},children:"Name: "}),A.name?A.name:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Email: "}),A.email?A.email:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Username: "}),A.username?A.username:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Bio: "}),A.bio?A.bio:null]})]})]}),Object(u.jsx)("h3",{className:"pop",children:"Waitlist"}),c.length>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:h.slice(T,T+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){T<h.length&&(h.length-T>8?L(T+8):L(0))},children:"Next"}),T>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return B(T-8)},children:"Back"}):null]}):null,Object(u.jsx)("h3",{className:"pop",children:"Received"}),r.length>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:d.slice(S,S+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return B(S+8)},children:"Next"}),S>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return B(S-8)},children:"Back"}):null]}):null,Object(u.jsx)("h3",{className:"pop",children:"Sponsored"}),O.length>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:O.slice(R,R+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return D(R+8)},children:"Next"}),R>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return D(R-8)},children:"Back"}):null]}):null]})):Object(u.jsx)(u.Fragment,{children:"Loading"})}var A=function(){var e=Object(s.useState)([]),t=Object(a.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)(null),r=Object(a.a)(c,2),l=r[0],j=r[1],b=Object(s.useState)([]),d=Object(a.a)(b,2),h=d[0],f=d[1],p=Object(s.useState)(0),O=Object(a.a)(p,2),m=O[0],x=O[1],v=Object(s.useState)(!0),k=Object(a.a)(v,2),w=k[0],N=k[1],S=Object(s.useState)(!1),B=Object(a.a)(S,2),_=B[0],I=B[1];return Object(s.useEffect)((function(){N(!1),I(!0),fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/books")).then((function(e){return e.json()})).then((function(e){return f(e)}))}),[l]),Object(s.useEffect)((function(){if(l){if(!1===w&&!0===_){var e={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({eligible:!0})};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/users/").concat(l.id),e)}if(!0===w||!1===_){var t={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({eligible:!1})};fetch("".concat("https://fast-citadel-52863.herokuapp.com/","/users/").concat(l.id),t)}}}),[w,_,h,l]),Object(u.jsxs)("div",{className:"app",children:[Object(u.jsx)(g,{setUser:j,user:l,setBooksFromSearch:i,startIndex:m,setStartIndex:x}),Object(u.jsxs)(o.d,{children:[Object(u.jsx)(o.a,{exact:!0,from:"/",to:"/home"}),Object(u.jsx)(o.b,{path:"/home",children:Object(u.jsx)(L,{})}),Object(u.jsx)(o.b,{path:"/bookindex",children:Object(u.jsx)(y,{booksFromSearch:n,startIndex:m,setStartIndex:x})}),Object(u.jsx)(o.b,{path:"/bookpage/:id",children:Object(u.jsx)(C,{savedBooks:h,setSavedBooks:f,user:l,setUser:j,reviewLeft:_,timeLeft:w,setBooksFromSearch:i,startIndex:m,setStartIndex:x})}),Object(u.jsx)(o.b,{path:"/otheruserpage/:id",children:Object(u.jsx)(U,{user:l,savedBooks:h,timeLeft:w,setTimeLeft:N,reviewLeft:_,setReviewLeft:I})}),Object(u.jsx)(o.b,{exact:!0,path:"/userpage",children:l?Object(u.jsx)(E,{user:l,savedBooks:h,timeLeft:w,setTimeLeft:N,reviewLeft:_,setReviewLeft:I}):Object(u.jsx)(o.a,{to:"/home"})})]})]})};r.a.render(Object(u.jsx)(i.a.StrictMode,{children:Object(u.jsx)(x.a,{children:Object(u.jsx)(A,{})})}),document.getElementById("root"))}},[[164,1,2]]]);
//# sourceMappingURL=main.2741be07.chunk.js.map