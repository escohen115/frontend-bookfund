(this.webpackJsonpbookfund=this.webpackJsonpbookfund||[]).push([[0],{150:function(e,t,n){},151:function(e,t,n){},164:function(e,t,n){"use strict";n.r(t);var s=n(1),i=n.n(s),c=n(56),o=n.n(c),r=(n(150),n(8)),l=(n(151),n(152),n(12)),a=n(176),u=n(0);function j(e){var t=e.setBooksFromSearch,n=e.startIndex,i=e.setStartIndex,c=Object(s.useState)(""),o=Object(r.a)(c,2),j=o[0],b=o[1],d=Object(l.g)();return Object(s.useEffect)((function(){var e=j.replace(/\s/g,"+");fetch("https://www.googleapis.com/books/v1/volumes?q=".concat(e,"&maxResults=8&startIndex=").concat(n)).then((function(e){return e.json()})).then((function(e){t(e.items)}))}),[n,j,t]),Object(u.jsx)("form",{onSubmit:function(e){e.preventDefault(),i(0);var s=j.replace(/\s/g,"+");fetch("https://www.googleapis.com/books/v1/volumes?q=".concat(s,"&maxResults=8&startIndex=").concat(n)).then((function(e){return e.json()})).then((function(e){t(e.items),d.push("/bookindex")}))},children:Object(u.jsx)(a.a,{icon:"search",placeholder:"Search...",type:"text",onChange:function(e){return b(e.target.value)},value:j,className:"search-input"})})}var b=n(29),d=n(39),h=n(178),f=n(165),p=n(177);function O(e){e.user;var t=e.setUser,n=Object(l.g)(),i=Object(s.useState)(!1),c=Object(r.a)(i,2),o=c[0],a=c[1],j=Object(s.useState)({eligible:!0}),O=Object(r.a)(j,2),x=O[0],m=O[1];function g(e){m(Object(d.a)(Object(d.a)({},x),{},Object(b.a)({},e.target.name,e.target.value)))}return console.log(x),Object(u.jsxs)(h.a,{onClose:function(){return a(!1)},onOpen:function(){return a(!0)},open:o,trigger:Object(u.jsx)(f.a,{children:"Sign Up"}),children:[Object(u.jsx)(h.a.Header,{children:"Sign Up"}),Object(u.jsx)(h.a.Content,{children:Object(u.jsxs)(p.a,{onSubmit:function(e){return function(e){e.preventDefault();var s=new FormData;s.append("profile_pic",x.profile_pic),s.append("username",x.username),s.append("name",x.name),s.append("bio",x.bio),s.append("email",x.email),console.log(x);var i={method:"POST",body:s};fetch("".concat("http://localhost:3000","/users"),i).then((function(e){return e.json()})).then((function(e){e.error?(alert("Username must be unique"),m({})):(alert("welcome aboard ".concat(e.username,"!")),t(e),m({}),n.push("/userpage"))}))}(e)},children:[Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Name"}),Object(u.jsx)("input",{placeholder:"Name",name:"name",onChange:function(e){return g(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Username"}),Object(u.jsx)("input",{placeholder:"Username",name:"username",onChange:function(e){return g(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Email"}),Object(u.jsx)("input",{placeholder:"Email",name:"email",onChange:function(e){return g(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{placeholder:"Password",type:"password"})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Bio"}),Object(u.jsx)("input",{placeholder:"Bio",name:"bio",onChange:function(e){return g(e)}})]}),Object(u.jsx)(p.a.Input,{type:"file",name:"profile_pic",fluid:!0,label:"Image Upload",onChange:function(e){return function(e){e.persist(),m(Object(d.a)(Object(d.a)({},x),{},Object(b.a)({},e.target.name,e.target.files[0])))}(e)}}),Object(u.jsx)(f.a,{type:"submit",style:{float:"right",marginBottom:"10px"},children:"Sign Up"})]})})]})}function x(e){var t=e.setUser,n=e.user,i=Object(l.g)(),c=Object(s.useState)(!1),o=Object(r.a)(c,2),a=o[0],j=o[1],d=Object(s.useState)({}),O=Object(r.a)(d,2),x=O[0],m=O[1];return Object(s.useEffect)((function(){i.push("/userpage")}),[n,i]),Object(u.jsxs)(h.a,{onClose:function(){return j(!1)},onOpen:function(){return j(!0)},open:a,trigger:Object(u.jsx)(f.a,{children:"Log In"}),children:[Object(u.jsx)(h.a.Header,{children:"Log In"}),Object(u.jsx)(h.a.Content,{children:Object(u.jsx)("div",{className:"form ",children:Object(u.jsxs)(p.a,{onSubmit:function(e){return function(e){e.preventDefault(),j(!1);var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)};fetch("".concat("http://localhost:3000","/users/login"),n).then((function(e){return e.json()})).then((function(e){console.log(e),t(e),i.push("/userpage")}))}(e)},children:[Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Username"}),Object(u.jsx)("input",{placeholder:"Username",name:"username",onChange:function(e){return function(e){m(Object(b.a)({},e.target.name,e.target.value))}(e)}})]}),Object(u.jsxs)(p.a.Field,{children:[Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{placeholder:"Password",type:"password"})]}),Object(u.jsx)(f.a,{type:"submit",style:{float:"right",marginBottom:"10px"},children:"Login"})]})})})]})}var m=n(11);function g(e){var t=e.setBooksFromSearch,n=e.setUser,s=e.user,i=e.startIndex,c=e.setStartIndex,o=Object(l.g)();return Object(u.jsx)("div",{className:"main-nav",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{className:"logo",children:Object(u.jsx)(m.c,{to:"/",style:{color:" #333"},children:Object(u.jsx)("h1",{className:"logo-text",children:"bookFun(d)"})})}),Object(u.jsx)("li",{className:"search-form",children:Object(u.jsx)(j,{setBooksFromSearch:t,startIndex:i,setStartIndex:c})}),Object(u.jsxs)("div",{className:"navLinks",children:[s?null:Object(u.jsx)(O,{user:s,setUser:n}),s?null:Object(u.jsx)(x,{style:{color:"inherit"},user:s,setUser:n}),s?Object(u.jsx)(f.a,{children:Object(u.jsx)(m.c,{style:{color:"inherit"},to:"/userpage",children:"  My Page  "})}):null,s?Object(u.jsx)(f.a,{onClick:function(){return o.push("/home"),void n(null)},children:"  Sign Out  "}):null,Object(u.jsx)(f.a,{children:Object(u.jsx)(m.c,{style:{color:"inherit"},to:"/",children:"  Home  "})})]})]})})}var v=n(179),k=n(135);function w(e){var t=e.book;return Object(u.jsxs)(v.a,{style:{textAlign:"center"},children:[Object(u.jsx)(k.a,{size:"tiny",src:t.volumeInfo.imageLinks?t.volumeInfo.imageLinks.thumbnail:null,wrapped:!0,ui:!1}),Object(u.jsxs)(v.a.Content,{children:[Object(u.jsx)(v.a.Header,{children:t.volumeInfo.title?Object(u.jsxs)(m.b,{to:"/bookpage/".concat(t.id),children:[t.volumeInfo.title.slice(0,50)," "]}):null}),Object(u.jsx)(v.a.Description,{children:t.volumeInfo.authors?t.volumeInfo.authors[0].slice(0,50):null})]})]})}function y(e){var t=e.booksFromSearch,n=e.startIndex,s=e.setStartIndex,i=[];return t&&(i=t.map((function(e){return Object(u.jsx)(w,{book:e})}))),Object(u.jsxs)("div",{className:"book-index",style:{marginTop:"100px"},children:[Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:i}),Object(u.jsxs)("div",{className:"buttons-combined",style:{marginTop:"20px"},children:[Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return s(n+8)},children:"Next"}),n>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return s(n-8)},children:"Back"}):null]})]})}function N(e){var t=e.waitingsMapped,n=e.book,i=e.user,c=(e.setUser,e.waitlistRequest),o=e.setWaitlistRequest,l=(e.setBackEndBook,e.backEndBook,e.toggleSponsorForm),a=e.setToggleSponsorForm,j=Object(s.useState)(0),b=Object(r.a)(j,2),d=b[0],h=b[1];return Object(u.jsxs)("form",{className:"signup",onSubmit:function(e){return function(e){e.preventDefault();var t={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({num_books_funded:e.target.number.value,sponsor_id:i.id})};fetch("".concat("http://localhost:3000","/waitings/sponsor/").concat(n.id),t).then((function(e){return e.json()})).then((function(e){a(!l),o(!c)}))}(e)},children:[Object(u.jsx)("label",{children:"Number of copies I'd like to sponsor:"}),Object(u.jsx)("input",{type:"number",name:"number",value:d,onChange:function(e){return h(e.target.value)}}),d>t.length?Object(u.jsx)("p",{style:{color:"red"},children:"Please enter a number smaller than the waitlist total"}):null,Object(u.jsx)("input",{type:"submit",value:"Sponsor",className:"button"})]})}var S=n(79),B=n.n(S);function _(e){var t=e.user,n=e.book,i=e.setSavedBooks,c=e.setWaitlistRequest,o=e.waitlistRequest,l=(e.waitListRequestAndStoreInDBRequest,e.backEndBook,e.setBackEndBook),a=e.storeInDB,j=Object(s.useState)({text:"",rating:0}),h=Object(r.a)(j,2),O=h[0],x=h[1];return Object(u.jsxs)("div",{children:[Object(u.jsx)("h3",{children:"Leave A Review"}),Object(u.jsx)(B.a,{className:"react-stars",count:5,onChange:function(e){t?(a(),x(Object(d.a)(Object(d.a)({},O),{},{rating:e}))):(x({}),alert("Please sign in to leave a rating."))},size:20,color2:"#ffd700",value:O.rating,name:"rating"}),Object(u.jsxs)(p.a,{reply:!0,onSubmit:function(e){return function(e){if(e.preventDefault(),O.text.length<100&&alert("Please leave a review with more than 100 characters."),O.text.length>100){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)};fetch("".concat("http://localhost:3000","/reviews"),t).then((function(e){c(!o),l(!0),fetch("".concat("http://localhost:3000","/books")).then((function(e){return e.json()})).then((function(e){i(e)}))}))}}(e)},children:[Object(u.jsx)(p.a.TextArea,{value:O.text,name:"text",rows:3,cols:25,onChange:function(e){return function(e){t?(a(),x(Object(d.a)(Object(d.a)({user_id:t.id,book_id:n.id},O),{},Object(b.a)({},e.target.name,e.target.value)))):(x({}),alert("Please sign in to leave a review."))}(e)}}),Object(u.jsx)(f.a,{type:"submit",content:"Add Review",labelPosition:"left",icon:"edit",primary:!0})]})]})}function C(e){var t=e.setSavedBooks,n=(e.savedBooks,e.user),i=e.setUser,c=(e.reviewLeft,Object(s.useState)({})),o=Object(r.a)(c,2),a=o[0],j=o[1],b=Object(s.useState)(!1),d=Object(r.a)(b,2),h=d[0],p=d[1],O=Object(s.useState)(!1),x=Object(r.a)(O,2),g=x[0],y=x[1],S=Object(s.useState)(!1),C=Object(r.a)(S,2),I=C[0],T=C[1],L=Object(s.useState)([]),R=Object(r.a)(L,2),P=R[0],F=R[1],D=Object(l.h)(),E=Object(s.useState)(0),A=Object(r.a)(E,2),U=A[0],M=A[1],z=Object(s.useState)(0),q=Object(r.a)(z,2),H=q[0],G=q[1],J=Object(s.useState)([]),W=Object(r.a)(J,2),V=W[0],K=W[1],Q=null,X=null,Y=null,Z=[],$=0,ee=[];function te(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""}function ne(){if(n){var e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};fetch("".concat("http://localhost:3000","/books"),e).then((function(e){return e.json()})).then((function(e){j(e),M(e.id);var t=e.id,s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:n.id,book_id:t,fulfilled:!1})};fetch("".concat("http://localhost:3000","/waitings"),s).then((function(e){return e.json()})).then((function(e){p(!0),y(!g),e.error&&alert("".concat(e.error))}))}))}else alert("Please sign in to join a waitlist.")}if(Object(s.useEffect)((function(){fetch("".concat("http://localhost:3000","/books")).then((function(e){return e.json()})).then((function(e){var t;t=e.find((function(e){return e.api_id===D.id})),j(t),t&&(M(t.id),p(!0)),t||fetch("https://www.googleapis.com/books/v1/volumes/".concat(D.id)).then((function(e){return e.json()})).then((function(e){var t="",n="",s=[""],i="",c="",o="",r="";e.volumeInfo.title&&(t=e.volumeInfo.title),e.volumeInfo.authors&&(s=e.volumeInfo.authors),e.volumeInfo.subtitle&&(n=e.volumeInfo.subtitle),e.volumeInfo.publisher&&(i=e.volumeInfo.publisher),e.volumeInfo.publishedDate&&(c=e.volumeInfo.publishedDate),e.volumeInfo.description&&(o=e.volumeInfo.description),e.volumeInfo.imageLinks&&(r=e.volumeInfo.imageLinks.thumbnail),j({title:t,subtitle:n,authors:s.join(", "),publisher:i,publishedDate:c,description:te(o),image_url:r,api_id:e.id,waitings:[],reviews:[]})}))})),fetch("".concat("http://localhost:3000","/users")).then((function(e){return e.json()})).then((function(e){return K(e)}))}),[g,h,D.id,U]),Object(s.useEffect)((function(){if(a&&a.title){var e=a.title.split(" ").pop();fetch("https://www.googleapis.com/books/v1/volumes?q=".concat(e,"&maxResults=20")).then((function(e){return e.json()})).then((function(e){F(e.items)}))}}),[a]),P.length>0&&(Z=P.slice(H,H+3).map((function(e){return Object(u.jsx)(w,{book:e})}))),!0===h&&a){if(V.length>0){var se=a.waitings.filter((function(e){return!0===e.fulfilled})),ie=[];ee=(ee=se.map((function(e){var t=se.filter((function(t){return t.sponsor_id===e.sponsor_id})).length;return ie.find((function(t){return t===e.sponsor_id}))?null:(ie.push(e.sponsor_id),Object(u.jsxs)("li",{children:[Object(u.jsx)(k.a,{src:V.find((function(t){return t.id===e.sponsor_id})).profile_pic?V.find((function(t){return t.id===e.sponsor_id})).profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsx)(m.b,{to:"/otheruserpage/".concat(e.sponsor_id),children:V.find((function(t){return t.id===e.sponsor_id})).username}),Object(u.jsxs)("div",{style:{float:"right"},children:[" ",t," ",1===t?" copy":"copies"]})]}))}))).filter((function(e){return null!==e}))}Q=a.waitings.map((function(e){if(!0!==e.fulfilled)return console.log(e.user),Object(u.jsxs)("li",{children:[Object(u.jsx)(k.a,{src:e.user.profile_pic?e.user.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsxs)(m.b,{to:"/otheruserpage/".concat(e.user.id),children:[e.user.username," ",e.user.eligible?"(eligible)":"(ineligible)"]})]})})),X=a.waitings.map((function(e){if(!0===e.fulfilled)return Object(u.jsxs)("li",{children:[Object(u.jsx)(k.a,{src:e.user.profile_pic?e.user.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsx)(m.b,{to:"/otheruserpage/".concat(e.user.id),children:e.user.username})]})})),Y=a.reviews.map((function(e){if(n){return $=a.reviews.map((function(e){return e.rating})).reduce((function(e,t){return e+t}))/a.reviews.length,Object(u.jsxs)("div",{className:"review",children:[Object(u.jsx)(k.a,{src:e.user.profile_pic?e.user.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsx)(m.b,{to:"/otheruserpage/".concat(e.user.id),children:e.user.username}),Object(u.jsx)(B.a,{className:"react-stars",count:5,value:e.rating,size:15,color2:"#ffd700",edit:!1}),e.text,e.user.id===n.id?Object(u.jsx)(f.a,{size:"mini",id:e.id,onClick:function(e){return function(e){var t=parseInt(e.target.id),n={method:"DELETE",headers:{"Content-Type":"application/json"}};fetch("".concat("http://localhost:3000","/reviews/").concat(t),n).then((function(e){return y(!g)}))}(e)},children:"Delete"}):null]})}return $=a.reviews.map((function(e){return e.rating})).reduce((function(e,t){return e+t}))/a.reviews.length,Object(u.jsxs)("li",{children:[Object(u.jsxs)("div",{children:[Object(u.jsx)(k.a,{src:e.user.profile_pic?e.user.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"mini",circular:!0}),Object(u.jsx)(m.b,{to:"/otheruserpage/".concat(e.user.id),children:e.user.username}),Object(u.jsx)(B.a,{className:"react-stars",count:5,value:e.rating,size:15,color2:"#ffd700",edit:!1})]}),e.text]})}))}return Object(u.jsxs)("div",{className:"bookpage",children:[Object(u.jsxs)("div",{className:"book-info",children:[Object(u.jsx)("div",{className:"book-info-image",children:Object(u.jsx)(k.a,{style:{margin:"40px",float:"right"},size:"small-medium",src:a?a.image_url:"N/A"})}),Object(u.jsxs)("div",{className:"book-info-info",children:[Object(u.jsx)("h2",{style:{marginBottom:"-15px"},children:a?a.title:"N/A"}),Object(u.jsx)("h3",{children:a?a.subtitle:"N/A"}),Y?Object(u.jsx)(B.a,{className:"react-stars",count:5,value:$,size:20,color2:"#ffd700",edit:!1}):null,Object(u.jsx)("b",{children:"by:"})," ",a?a.authors:"N/A"," (",a?a.publishedDate:"N/A",")",Object(u.jsx)("br",{}),Object(u.jsx)("b",{children:"Publishing House:"})," ",a?a.publisher:"N/A",Object(u.jsx)("br",{}),Object(u.jsx)("b",{children:"Description:"}),Object(u.jsx)("p",{children:a?a.description:"N/A"})]})]}),a?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{className:"reviews",children:[Object(u.jsx)("h3",{children:"Reviews"}),h&&Y.length>0?Object(u.jsxs)("ul",{className:"reviewsUl",children:[" ",Y," "]}):"No one has reviewed this book yet. Be the first!",Object(u.jsx)(_,{storeInDB:function(){if(n){var e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};fetch("".concat("http://localhost:3000","/books"),e).then((function(e){return e.json()})).then((function(e){j(e),M(e.id),p(!0),y(!g)}))}else alert("Please sign in to leave a review.")},user:n,book:a,waitlistRequest:g,setWaitlistRequest:y,backEndBook:h,setBackEndBook:p,setSavedBooks:t,waitListRequestAndStoreInDBRequest:ne,toggleSponsorForm:I,setToggleSponsorForm:T})]}),Object(u.jsxs)("div",{className:"bookpage-recipients-list",children:[Object(u.jsx)("h3",{style:{textAlign:"center"},children:"Recipients"}),h&&X.length>0?Object(u.jsxs)("ol",{children:[" ",X,"  "]}):"No one has received this book yet. Join the waitlist to be the first!"]}),Object(u.jsxs)("div",{className:"bookpage-waiting-list",children:[Object(u.jsx)("h3",{style:{textAlign:"center"},children:"Waitlist"}),Object(u.jsxs)("ol",{children:[h&&Q.length>0?Q:"No one is currently waiting for this book. Be the first!"," "]}),Object(u.jsx)(f.a,{className:"waiting-button",onClick:ne,children:"Join the Waitlist"})]}),Object(u.jsxs)("div",{className:"bookpage-sponsor-list",children:[Object(u.jsx)("h3",{style:{textAlign:"center"},children:"Sponsors"}),Object(u.jsxs)("ol",{children:[h&&ee.length>0?ee:"No one has sponsored this book yet.  Be the first!"," "]}),Object(u.jsx)(f.a,{onClick:function(){n?h?T(!I):alert("There is no one on the waitlist."):alert("Please log in to Sponsor")},children:" Sponsor this Book"}),I?Object(u.jsx)(N,{waitingsMapped:Q,book:a,user:n,setUser:i,waitlistRequest:g,setWaitlistRequest:y,setBackEndBook:p,backEndBook:h,setToggleSponsorForm:T,toggleSponsorForm:I}):null]})]}):null,Object(u.jsxs)("div",{className:"similar-books",children:[Object(u.jsx)("h3",{children:"Similar Books"}),P.length>0?Object(u.jsx)(v.a.Group,{itemsPerRow:3,children:Z}):null,Object(u.jsxs)("div",{className:"buttons-combined",children:[Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){H<P.length-2?G(H+3):alert("No More Books to Display")},children:"See More"}),H>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){G(H-3)},children:"Go Back"}):null]})]})]})}function I(e){var t=e.book,n=e.style;return t?Object(u.jsxs)(v.a,{style:n,children:[Object(u.jsx)(k.a,{size:"small",src:t.image_url?t.image_url:null,wrapped:!0,ui:!1}),Object(u.jsxs)(v.a.Content,{children:[Object(u.jsx)(v.a.Header,{children:t.title?Object(u.jsxs)(m.b,{to:"/bookpage/".concat(t.api_id),children:[t.title.slice(0,50)," "]}):null}),Object(u.jsx)(v.a.Meta,{children:t.subtitle?t.subtitle.slice(0,50):null}),Object(u.jsx)(v.a.Description,{children:Object(u.jsx)("span",{className:"date",children:t.authors?t.authors:null})})]})]}):null}var T=n(61);function L(){var e=Object(s.useState)([]),t=Object(r.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)([]),o=Object(r.a)(c,2),l=o[0],a=o[1],j=Object(s.useState)([]),d=Object(r.a)(j,2),h=d[0],p=d[1],O=Object(s.useState)(0),x=Object(r.a)(O,2),g=x[0],w=x[1],y=[],N=[],S=[],B=[],_=[];if(Object(s.useEffect)((function(){fetch("".concat("http://localhost:3000","/books")).then((function(e){return e.json()})).then((function(e){i(e)})),fetch("".concat("http://localhost:3000","/users")).then((function(e){return e.json()})).then((function(e){p(e)})),fetch("".concat("http://localhost:3000","/waitings")).then((function(e){return e.json()})).then((function(e){a(e)}))}),[]),n.length>0){for(var C=0;C<n.length;C++){var L=n[C].waitings.filter((function(e){return!1!==e.fulfilled})).length;y.push(Object(b.a)({},L,n[C]))}y.sort((function(e,t){return Object.keys(t)[0]-Object.keys(e)[0]})),N=y.slice(g,g+8).map((function(e){return Object(u.jsx)(I,{book:Object.values(e)[0]})}))}if(l.length>0){for(var R=l.filter((function(e){return!0===e.fulfilled})),P=[],F=function(e){var t=R.filter((function(t){return t.sponsor_id===h[e].id}));P.push(Object(b.a)({},t.length,h[e]))},D=0;D<h.length;D++)F(D);S=P.sort((function(e,t){return Object.keys(t)[0]-Object.keys(e)[0]})).slice(0,3).map((function(e){return Object(u.jsxs)(v.a,{children:[Object(u.jsx)(v.a.Header,{children:Object(u.jsxs)(m.b,{to:"/otheruserpage/".concat(Object.values(e)[0].id),children:[" ",Object(u.jsx)("h4",{style:{textAlign:"center"},children:Object.values(e)[0].username})," "]})}),Object(u.jsx)(v.a.Content,{style:{textAlign:"center"},children:Object(u.jsx)(k.a,{style:{margin:"auto"},src:Object.values(e)[0].profile_pic?Object.values(e)[0].profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"small",circular:!0})}),Object(u.jsxs)(v.a.Content,{extra:!0,children:[Object(u.jsx)(T.a,{name:"user"}),Object.keys(e)[0]," sponsors"]})]})}))}return h.length>0&&(B=h.sort((function(e,t){return t.waitings.filter((function(e){return!0===e.fulfilled})).length-e.waitings.filter((function(e){return!0===e.fulfilled})).length})),console.log(B),_=B.slice(0,3).map((function(e){return Object(u.jsxs)(v.a,{children:[Object(u.jsx)(v.a.Header,{children:Object(u.jsxs)(m.b,{to:"/otheruserpage/".concat(e.id),children:[" ",Object(u.jsxs)("h4",{style:{textAlign:"center"},children:[e.username," "]})]})}),Object(u.jsx)(v.a.Content,{style:{textAlign:"center"},children:Object(u.jsx)(k.a,{src:e.profile_pic?e.profile_pic:"https://www.xovi.com/wp-content/plugins/all-in-one-seo-pack/images/default-user-image.png",size:"small",circular:!0})}),Object(u.jsxs)(v.a.Content,{extra:!0,children:[Object(u.jsx)(T.a,{name:"book"}),e.waitings.filter((function(e){return!0===e.fulfilled})).length," Books Read"]})]})}))),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{className:"home-info",children:[Object(u.jsx)("h2",{className:"who",children:"Who we are"}),Object(u.jsxs)("p",{style:{fontSize:"15px"},children:["If you've ever read an impactful book that you'd like to share with others, BookFund is the place for you!",Object(u.jsx)("br",{}),"BookFund is a simple way for users to sponsor books they love and share the knowledge with others.",Object(u.jsx)("br",{}),"Users can sign up for a book via a waitlist to receive the next sponsored copy of that book. After receiving a book, users must publish a review of the book on the site, as well as enter a two week wait period before they are eligible to receive their next book."]})]}),Object(u.jsx)("h2",{className:"pop",children:"Popular Now"}),Object(u.jsx)("div",{className:"popular-now",children:N.length>0?Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:N}):null}),Object(u.jsxs)("div",{className:"buttons-combined",children:[Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return w(g+8)},children:"Next"}),g>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return w(g-8)},children:"Back"}):null]}),Object(u.jsxs)("div",{style:{display:"flex",marginTop:"50px"},className:"bottom-home",children:[Object(u.jsxs)("div",{className:"top-readers-home",children:[Object(u.jsx)("h4",{children:"Top Readers:"}),Object(u.jsx)(v.a.Group,{itemsPerRow:3,children:_.length>0?_:null})]}),Object(u.jsxs)("div",{className:"top-sponsors-home",children:[Object(u.jsx)("h4",{children:"Top Sponsors:"}),Object(u.jsx)(v.a.Group,{itemsPerRow:3,children:S.length>0?S:null})]})]})]})}var R=function(e){var t=e.mostRecent,n=(e.timeLeft,e.setTimeLeft),i=(e.displayTimer,e.setDisplayTimerTwo),c=(e.reviewLeft,Object(s.useState)(0)),o=Object(r.a)(c,2),l=o[0],a=o[1],j=Object(s.useState)(0),b=Object(r.a)(j,2),d=b[0],h=b[1],f=Object(s.useState)(0),p=Object(r.a)(f,2),O=p[0],x=p[1],m=Object(s.useState)(0),g=Object(r.a)(m,2),v=g[0],k=g[1],w=Object(s.useRef)();return Object(s.useEffect)((function(){return function(){var e=new Date(parseInt(t.sponsor_date)+6e4);w=setInterval((function(){var t=(new Date).getTime(),s=e-t,c=Math.floor(s/864e5),o=Math.floor(s%864e5/36e5),r=Math.floor(s%36e5/6e4),l=Math.floor(s%6e4/1e3);s<0?(n(!1),clearInterval(w.current),!1,i(!1)):(a(c),h(o),x(r),k(l))}),1e3)}(),function(){clearInterval(w.current)}})),Object(u.jsxs)("div",{class:"container",children:[Object(u.jsx)("h1",{id:"headline",children:"Countdown until your next book:"}),Object(u.jsx)("div",{id:"countdown",children:Object(u.jsxs)("ul",{children:[Object(u.jsxs)("li",{children:[Object(u.jsx)("span",{id:"numbers",children:l}),"days"]}),Object(u.jsxs)("li",{children:[Object(u.jsx)("span",{id:"numbers",children:d}),"Hours"]}),Object(u.jsxs)("li",{children:[Object(u.jsx)("span",{id:"numbers",children:O}),"Minutes"]}),Object(u.jsxs)("li",{children:[Object(u.jsxs)("span",{id:"numbers",children:[v," "]}),"Seconds"]})]})})]})};function P(e){var t=e.allWaitings,n=e.user,i=e.savedBooks,c=[],o=[],l=Object(s.useState)(0),a=Object(r.a)(l,2),j=a[0],b=a[1];if(t.length>0&&(c=t.filter((function(e){return e.sponsor_id===n.id}))).length>0){var d=[];d.push(c[0]);for(var h=function(e){d.find((function(t){return t.book_id===c[e].book_id}))||d.push(c[e])},p=1;p<c.length;p++)h(p);o=d.map((function(e){return Object(u.jsx)(I,{book:i.find((function(t){return t.id===e.book_id}))})})),console.log(o)}return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:o.slice(j,j+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return b(j+8)},children:"Next"}),j>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return b(j-8)},children:"Back"}):null]})}function F(e){for(var t=e.waitlistMapped,n=e.user,i=e.savedBooks,c=Object(s.useState)(0),o=Object(r.a)(c,2),l=o[0],a=o[1],j=[],b=n.waitings.filter((function(e){return!0!==e.fulfilled})),d=function(e){j.push(i.find((function(t){return t.id===b[e].book_id})))},h=0;h<b.length;h++)d(h);return j.length>0&&(t=j.map((function(e){return Object(u.jsx)(I,{book:e})}))),j.length>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:t.slice(l,l+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){l<t.length&&(t.length-l>8?a(l+8):a(0))},children:"Next"}),l>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return a(l-8)},children:"Back"}):null]}):null}function D(e){var t=e.savedBooks,n=e.waitingsFulFilledMapped,i=e.waitlistMapped,c=Object(s.useState)(0),o=Object(r.a)(c,2),l=o[0],a=o[1],j=null;return t.length>0&&(j=n.map((function(e){return Object(u.jsx)(I,{book:e})}))),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:j.slice(l,l+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){l<i.length&&(i.length-l>8?a(l+8):a(0))},children:"Next"}),l>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return a(l-8)},children:"Back"}):null]})}function E(e){var t=e.user,n=e.savedBooks,i=e.timeLeft,c=e.setTimeLeft,o=e.reviewLeft,a=e.setReviewLeft,j=[],b={},d=null,h=null,f=!1,p=Object(s.useState)([]),O=Object(r.a)(p,2),x=O[0],m=O[1],g=Object(s.useState)(!0),v=Object(r.a)(g,2),w=v[0],y=v[1];return Object(s.useEffect)((function(){fetch("".concat("http://localhost:3000","/waitings")).then((function(e){return e.json()})).then((function(e){return m(e)}))}),[]),t&&function(){t.waitings.length<1&&(console.log("setTimeLeft(false)"),c(!1),a(!0));for(var e=t.waitings.filter((function(e){return!0===e.fulfilled})),s=function(t){j.push(n.find((function(n){return n.id===e[t].book_id})))},i=0;i<e.length;i++)s(i);if(e.length<1&&a(!0),e.length>0){if(b=e.sort((function(e,t){return t.id-e.id}))[0],0!==Object.keys(b).length){var o=new Date(parseInt(b.sponsor_date)+6e4).getTime();(new Date).getTime()<o?f=!0:(f=!1,console.log("setTimeLeft(false)"),c(!1))}(d=n.find((function(e){return e.id===b.book_id})))?(h=d.reviews.find((function(e){return e.user.id===t.id})),a(!!h)):a(!0)}}(),t?Object(u.jsxs)("div",{className:"userpage",children:[Object(u.jsxs)("div",{className:"userpage-top-half",children:[Object(u.jsxs)("div",{className:"userpage-eligibility-info",style:{float:"left"},children:[f&&w?Object(u.jsx)(R,{mostRecent:b,timeLeft:i,setTimeLeft:c,displayTimer:f,setDisplayTimerTwo:y,reviewLeft:o}):null,!1===f&&!0===o?Object(u.jsx)("h3",{children:"Looks like you're eligible for your next book!"}):null,!1===o&&null!==b&&t.waitings.length>0?Object(u.jsxs)("div",{style:{margin:"auto"},children:[" ",Object(u.jsx)("h3",{children:"Please leave a review for"})," ",Object(u.jsx)("div",{style:{margin:"auto"},children:Object(u.jsx)(I,{book:d,style:{margin:"auto"}})})," "]}):null]}),Object(u.jsxs)("div",{className:"userpage-user-info",children:[Object(u.jsx)("h3",{children:"Profile"}),Object(u.jsx)(k.a,{src:t.profile_pic?t.profile_pic:null,size:"small",circular:!0,style:{float:"left"}}),Object(u.jsxs)("div",{style:{float:"left",marginLeft:"50px"},children:[Object(u.jsx)("h4",{style:{display:"inline"},children:"Name: "}),"undefined"!==t.name?t.name:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Email: "}),"undefined"!==t.email?t.email:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Username: "}),"undefined"!==t.username?t.username:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Bio: "}),"undefined"!==t.bio?t.bio:null]})]})]}),Object(u.jsx)("h3",{className:"pop",children:"Waitlist"}),Object(u.jsx)(F,{waitlistMapped:0,user:t,savedBooks:n}),Object(u.jsx)("h3",{className:"pop",children:"Received"}),j.length>0?Object(u.jsx)(D,{waitingsFulFilledMapped:j,savedBooks:n,waitlistMapped:0}):null,Object(u.jsx)("h3",{className:"pop",children:"Sponsored"}),Object(u.jsx)(P,{allWaitings:x,savedBooks:n,user:t})]}):Object(u.jsxs)(u.Fragment,{children:["Error. Please try again",Object(u.jsx)(l.a,{to:"/bookindex"})]})}function A(e){var t=e.savedBooks,n=e.timeLeft,i=e.setTimeLeft,c=e.reviewLeft,o=e.setReviewLeft,a=[],j=[],b={},d=null,h=null,p=null,O=null,x=[],m=[],g=Object(s.useState)([]),w=Object(r.a)(g,2),y=w[0],N=w[1],S=Object(s.useState)(0),B=Object(r.a)(S,2),_=B[0],C=B[1],T=Object(s.useState)(0),L=Object(r.a)(T,2),R=L[0],P=L[1],F=Object(s.useState)(0),D=Object(r.a)(F,2),E=D[0],A=D[1],U=Object(s.useState)(null),M=Object(r.a)(U,2),z=M[0],q=M[1],H=Object(l.h)();return Object(s.useEffect)((function(){fetch("".concat("http://localhost:3000","/users/").concat(H.id)).then((function(e){return e.json()})).then((function(e){return q(e)}))}),[H.id]),Object(s.useEffect)((function(){fetch("".concat("http://localhost:3000","/waitings")).then((function(e){return e.json()})).then((function(e){return N(e)}))}),[]),z&&function(){z.waitings.length<1&&(console.log("setTimeLeft(false)"),i(!1),o(!0));for(var e=z.waitings.filter((function(e){return!0!==e.fulfilled})),n=function(n){a.push(t.find((function(t){return t.id===e[n].book_id})))},s=0;s<e.length;s++)n(s);if(a.length>0&&(O=a.map((function(e){return Object(u.jsx)(I,{book:e})}))),y.length>0&&(x=y.filter((function(e){return e.sponsor_id===z.id}))).length>0){var c=[];c.push(x[0]);for(var r=function(e){c.find((function(t){return t.book_id===x[e].book_id}))||c.push(x[e])},l=1;l<x.length;l++)r(l);m=c.map((function(e){return Object(u.jsx)(I,{book:t.find((function(t){return t.id===e.book_id}))})}))}for(var f=z.waitings.filter((function(e){return!0===e.fulfilled})),g=function(e){j.push(t.find((function(t){return t.id===f[e].book_id})))},v=0;v<f.length;v++)g(v);if(f.length<1&&o(!0),t.length>0&&(p=j.map((function(e){return Object(u.jsx)(I,{book:e})}))),f.length>0){if(b=f.sort((function(e,t){return t.id-e.id}))[0],0!==Object.keys(b).length){var k=new Date(parseInt(b.sponsor_date)+6e4).getTime();(new Date).getTime()<k?!0:(!1,console.log("setTimeLeft(false)"),i(!1))}(d=t.find((function(e){return e.id===b.book_id})))?(h=d.reviews.find((function(e){return e.user.id===z.id})),o(!!h)):o(!0)}}(),z?(console.log("timeleft:",n),console.log("reviewleft:",c),Object(u.jsxs)("div",{className:"userpage",children:[Object(u.jsxs)("div",{className:"userpage-top-half",children:[Object(u.jsx)("div",{className:"userpage-eligibility-info",style:{float:"left"},children:z.eligible?Object(u.jsxs)("h3",{children:["Looks like ",z.username," is eligible for their next book!"]}):Object(u.jsxs)("h3",{children:["Looks like ",z.username," needs to wait two weeks or leave a review to be eligible for their next book!"]})}),Object(u.jsxs)("div",{className:"userpage-user-info",children:[Object(u.jsx)("h3",{children:"Profile"}),Object(u.jsx)(k.a,{src:z.profile_pic?z.profile_pic:null,size:"small",circular:!0,style:{float:"left"}}),Object(u.jsxs)("div",{style:{float:"left",marginLeft:"50px"},children:[Object(u.jsx)("h4",{style:{display:"inline"},children:"Name: "}),z.name?z.name:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Email: "}),z.email?z.email:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Username: "}),z.username?z.username:null,Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("h4",{style:{display:"inline"},children:"Bio: "}),z.bio?z.bio:null]})]})]}),Object(u.jsx)("h3",{className:"pop",children:"Waitlist"}),a.length>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:O.slice(R,R+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){R<O.length&&(O.length-R>8?P(R+8):P(0))},children:"Next"}),R>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return C(R-8)},children:"Back"}):null]}):null,Object(u.jsx)("h3",{className:"pop",children:"Received"}),j.length>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:p.slice(_,_+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return C(_+8)},children:"Next"}),_>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return C(_-8)},children:"Back"}):null]}):null,Object(u.jsx)("h3",{className:"pop",children:"Sponsored"}),m.length>0?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"userpage-book-display",children:Object(u.jsx)(v.a.Group,{itemsPerRow:8,children:m.slice(E,E+8)})}),Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return A(E+8)},children:"Next"}),E>0?Object(u.jsx)(f.a,{className:"next-back-button",onClick:function(){return A(E-8)},children:"Back"}):null]}):null]})):Object(u.jsx)(u.Fragment,{children:"Loading"})}var U=function(){var e=Object(s.useState)([]),t=Object(r.a)(e,2),n=t[0],i=t[1],c=Object(s.useState)(null),o=Object(r.a)(c,2),a=o[0],j=o[1],b=Object(s.useState)([]),d=Object(r.a)(b,2),h=d[0],f=d[1],p=Object(s.useState)(0),O=Object(r.a)(p,2),x=O[0],m=O[1],v=Object(s.useState)(!0),k=Object(r.a)(v,2),w=k[0],N=k[1],S=Object(s.useState)(!1),B=Object(r.a)(S,2),_=B[0],I=B[1];return Object(s.useEffect)((function(){N(!0),I(!1),fetch("".concat("http://localhost:3000","/books")).then((function(e){return e.json()})).then((function(e){return f(e)}))}),[a]),Object(s.useEffect)((function(){if(a){if(!1===w&&!0===_){var e={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({eligible:!0})};fetch("".concat("http://localhost:3000","/users/").concat(a.id),e)}if(!0===w||!1===_){var t={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({eligible:!1})};fetch("".concat("http://localhost:3000","/users/").concat(a.id),t)}}}),[w,_,h,a]),Object(u.jsxs)("div",{className:"app",children:[Object(u.jsx)(g,{setUser:j,user:a,setBooksFromSearch:i,startIndex:x,setStartIndex:m}),Object(u.jsxs)(l.d,{children:[Object(u.jsx)(l.a,{exact:!0,from:"/",to:"/home"}),Object(u.jsx)(l.b,{path:"/home",children:Object(u.jsx)(L,{})}),Object(u.jsx)(l.b,{path:"/bookindex",children:Object(u.jsx)(y,{booksFromSearch:n,startIndex:x,setStartIndex:m})}),Object(u.jsx)(l.b,{path:"/bookpage/:id",children:Object(u.jsx)(C,{savedBooks:h,setSavedBooks:f,user:a,setUser:j,reviewLeft:_,timeLeft:w,setBooksFromSearch:i,startIndex:x,setStartIndex:m})}),Object(u.jsx)(l.b,{path:"/otheruserpage/:id",children:Object(u.jsx)(A,{user:a,savedBooks:h,timeLeft:w,setTimeLeft:N,reviewLeft:_,setReviewLeft:I})}),Object(u.jsx)(l.b,{exact:!0,path:"/userpage",children:a?Object(u.jsx)(E,{user:a,savedBooks:h,timeLeft:w,setTimeLeft:N,reviewLeft:_,setReviewLeft:I}):Object(u.jsx)(l.a,{to:"/home"})})]})]})};o.a.render(Object(u.jsx)(i.a.StrictMode,{children:Object(u.jsx)(m.a,{children:Object(u.jsx)(U,{})})}),document.getElementById("root"))}},[[164,1,2]]]);
//# sourceMappingURL=main.5d9f5764.chunk.js.map